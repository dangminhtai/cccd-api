{% extends "portal/base_portal.html" %}

{% block title %}CCCD API Developer Dashboard{% endblock %}

{% block extra_css %}
<style>
    body {
        background-color: #101628;
        background-image: 
            radial-gradient(at 0% 0%, rgba(59, 130, 246, 0.15) 0px, transparent 50%),
            radial-gradient(at 100% 100%, rgba(102, 127, 234, 0.15) 0px, transparent 50%);
        background-attachment: fixed;
    }
    
    .bg-icon {
        position: fixed;
        opacity: 0.05;
        color: white;
        z-index: 0;
        pointer-events: none;
    }
    
    .bg-icon-1 { 
        top: 15%; 
        left: 5%; 
        transform: rotate(-15deg); 
        font-size: 64px; 
    }
    
    .bg-icon-2 { 
        bottom: 20%; 
        right: 10%; 
        transform: rotate(10deg); 
        font-size: 80px; 
    }
    
    .bg-icon-3 { 
        top: 30%; 
        right: 25%; 
        transform: rotate(5deg); 
        font-size: 48px; 
    }
    
    .glass-panel {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }
    
    .dashboard-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(8px);
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    }
    
    .dashboard-card:hover {
        transform: translateY(-2px);
        background: rgba(255, 255, 255, 0.08);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
        border-color: rgba(255, 255, 255, 0.15);
    }
    
    .warning-banner {
        background: rgba(245, 158, 11, 0.1);
        border: 1px solid rgba(245, 158, 11, 0.2);
        color: #fbbf24;
        box-shadow: 0 0 15px rgba(245, 158, 11, 0.1);
    }
    
    .flash-success {
        background: rgba(16, 185, 129, 0.1);
        color: #6ee7b7;
        border: 1px solid rgba(16, 185, 129, 0.2);
    }
    .flash-error {
        background: rgba(239, 68, 68, 0.1);
        color: #fca5a5;
        border: 1px solid rgba(239, 68, 68, 0.2);
    }
    .flash-warning {
        background: rgba(245, 158, 11, 0.1);
        color: #fbbf24;
        border: 1px solid rgba(245, 158, 11, 0.2);
    }
    .flash-info {
        background: rgba(59, 130, 246, 0.1);
        color: #93c5fd;
        border: 1px solid rgba(59, 130, 246, 0.2);
    }
</style>
{% endblock %}

{% block content %}
<!-- Background Icons -->
<span class="material-symbols-outlined bg-icon bg-icon-1">dns</span>
<span class="material-symbols-outlined bg-icon bg-icon-2">fingerprint</span>
<span class="material-symbols-outlined bg-icon bg-icon-3">security</span>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="mb-6">
            {% for category, message in messages %}
                <div class="flash flash-{{ category }} mb-3 p-3 rounded-lg text-sm">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endwith %}

<!-- Warning Banner for Email Verification -->
{% if not user.email_verified %}
<div class="mb-8 p-4 warning-banner rounded-xl flex items-center gap-3 shadow-sm backdrop-blur-sm">
    <span class="material-symbols-outlined text-amber-400">warning</span>
    <span class="text-sm font-medium text-amber-100">TÃ i khoáº£n cá»§a báº¡n chÆ°a Ä‘Æ°á»£c xÃ¡c thá»±c email. Vui lÃ²ng kiá»ƒm tra há»™p thÆ° Ä‘áº¿n.</span>
    <a href="{{ url_for('portal.resend_verification') }}" class="ml-auto text-sm font-bold text-amber-400 hover:text-amber-300 underline decoration-2 underline-offset-2">Gá»­i láº¡i email</a>
</div>
{% endif %}

<!-- Glass Panel Container -->
<div class="glass-panel rounded-2xl p-1"> 
    <div class="bg-navy-deep/40 rounded-xl p-8 md:p-10"> 
        <!-- Welcome Card -->
        <div class="dashboard-card w-full p-8 md:p-10 mb-8 relative overflow-hidden group border border-white/10">
            <div class="absolute top-0 right-0 w-80 h-80 bg-gradient-to-br from-primary/20 to-electric-blue/20 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/4 pointer-events-none"></div>
            <div class="relative z-10">
                <h1 class="text-2xl md:text-3xl font-bold text-white mb-3 flex items-center gap-2">
                    ChÃ o má»«ng trá»Ÿ láº¡i! 
                    <span class="animate-bounce inline-block">ðŸ‘‹</span>
                </h1>
                <p class="text-slate-400 text-lg max-w-2xl leading-relaxed">
                    Quáº£n lÃ½ API keys, xem usage statistics vÃ  nÃ¢ng cáº¥p tier cá»§a báº¡n. Há»‡ thá»‘ng Ä‘ang hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh 99.9%.
                </p>
            </div>
        </div>
        
        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Current Tier Card -->
            <div class="dashboard-card p-8 flex flex-col justify-center h-48 border border-white/5">
                <div class="flex items-center gap-2 mb-4">
                    <span class="text-xs font-bold text-slate-400 tracking-wider uppercase">Tier hiá»‡n táº¡i</span>
                </div>
                <div>
                    {% if subscription and subscription.tier %}
                        {% set tier = subscription.tier|upper %}
                        {% if tier == "ULTRA" %}
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-purple-500/20 text-purple-300 border border-purple-500/30 tracking-wide shadow-[0_0_10px_rgba(168,85,247,0.2)]">
                                {{ tier }}
                            </span>
                        {% elif tier == "PREMIUM" %}
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-blue-500/20 text-blue-300 border border-blue-500/30 tracking-wide shadow-[0_0_10px_rgba(59,130,246,0.2)]">
                                {{ tier }}
                            </span>
                        {% else %}
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-gray-500/20 text-gray-300 border border-gray-500/30 tracking-wide shadow-[0_0_10px_rgba(156,163,175,0.2)]">
                                {{ tier }}
                            </span>
                        {% endif %}
                    {% else %}
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold bg-gray-500/20 text-gray-300 border border-gray-500/30 tracking-wide shadow-[0_0_10px_rgba(156,163,175,0.2)]">
                            FREE
                        </span>
                    {% endif %}
                </div>
                <div class="mt-4 w-full bg-slate-700/50 rounded-full h-1.5 overflow-hidden">
                    <div class="bg-gradient-to-r from-purple-600 to-purple-400 h-1.5 rounded-full shadow-[0_0_8px_rgba(168,85,247,0.5)]" style="width: 85%"></div>
                </div>
                <p class="text-xs text-slate-500 mt-2">85% giá»›i háº¡n sá»­ dá»¥ng</p>
            </div>
            
            <!-- Email Card -->
            <div class="dashboard-card p-8 flex flex-col justify-center h-48 border border-white/5">
                <div class="flex items-center gap-2 mb-2">
                    <span class="text-xs font-bold text-slate-400 tracking-wider uppercase">Email</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-blue-500/10 border border-blue-500/20 flex items-center justify-center text-blue-400 flex-shrink-0 shadow-[0_0_10px_rgba(59,130,246,0.1)]">
                        <span class="material-symbols-outlined text-[20px]">mail</span>
                    </div>
                    <p class="text-lg font-semibold text-white truncate" title="{{ user.email }}">{{ user.email }}</p>
                </div>
            </div>
            
            <!-- Registration Date Card -->
            <div class="dashboard-card p-8 flex flex-col justify-center h-48 border border-white/5">
                <div class="flex items-center gap-2 mb-2">
                    <span class="text-xs font-bold text-slate-400 tracking-wider uppercase">NgÃ y Ä‘Äƒng kÃ½</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center text-emerald-400 flex-shrink-0 shadow-[0_0_10px_rgba(16,185,129,0.1)]">
                        <span class="material-symbols-outlined text-[20px]">calendar_today</span>
                    </div>
                    <p class="text-xl font-semibold text-white">
                        {% if user.created_at %}
                            {{ user.created_at.strftime('%d/%m/%Y') }}
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Support Link -->
        <div class="mt-8 flex justify-center">
            <p class="text-sm text-slate-500">
                Cáº§n há»— trá»£ ká»¹ thuáº­t? 
                <a class="text-electric-blue hover:text-blue-400 hover:underline font-medium transition-colors" href="#">LiÃªn há»‡ Ä‘á»™i ngÅ© há»— trá»£</a>
            </p>
        </div>
    </div>
</div>
{% endblock %}
